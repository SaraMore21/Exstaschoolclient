<ngx-ui-loader></ngx-ui-loader>

<body class="myForm" dir="rtl">
  <!-- <div [ngStyle]="{ 'pointer-events': lockForm() }"> -->
  <h1 style="text-align: center; background-color: cornflowerblue">איש קשר</h1>

  <div class="p-fluid p-formgrid p-grid">
    <div>
      <form #form="ngForm" id="form" name="form" dir="rtl">
        <div class="p-fluid p-formgrid p-grid">
          <div class="p-field p-col-2"></div>
          <div class="p-field p-col-8">
            <div class="p-fluid p-formgrid p-grid">
              <h5 class="p-field p-col-12" style="font-weight: bold">
                פרטי משתמש
              </h5>
              <div class="row">
                <!-- תעודת זהות -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label for="Tz" class="w3-text-grey">מספר זהות</label>
                  <label class="w3-text-red"> * </label>
                  <br />
                  <input class="myInput" name="Tz" id="Tz" type="text" #Tz="ngModel" required pInputText
                    [(ngModel)]="contactService.currentContact.tz" (change)="CheckTz()" [pKeyFilter]="blockSpecial" maxlength="9"
                    [disabled]="flagAddContactOrAddContactPerStudentAndUpdateContact||studentService.flagAddOrUpdateContact == false"/>
                  <div *ngIf=" Tz.invalid && (Tz.touched || Tz.dirty) ">
                    <div *ngIf="Tz.errors.required" class="w3-text-red">
                      שדה חובה
                    </div>
                  </div>
                </div>

                <!-- סוג זיהוי; -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label class="w3-text-grey">סוג זיהוי</label>
                  <p-dropdown dir="rtl" name="TypeIdentityId" class="myInput" [options]="schoolService.TypeIdentitys"
                    optionLabel="name" [(ngModel)]="typeIdentity" [style]="{ width: '100%' }" filter="true"
                    emptyFilterMessage="לא נמצאו נתונים העונים על החיפוש" emptyMessage="אין נתונים קיימים"
                    [disabled]="flagAddContactOrAddContactPerStudentAndUpdateContact||studentService.flagAddOrUpdateContact == false">
                  </p-dropdown>

                </div>
                <!-- שם פרטי -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label for="Tz" class="w3-text-grey"> שם פרטי</label>
                  <label class="w3-text-red"> * </label>
                  <br />
                  <input class="myInput" name="FirstName" id="FirstName" type="text" #FirstName="ngModel" required
                    pInputText [(ngModel)]="contactService.currentContact.firstName" />
                  <div *ngIf="
                    FirstName.invalid && (FirstName.touched || FirstName.dirty)
                  ">
                    <div *ngIf="FirstName.errors.required" class="w3-text-red">
                      שדה חובה
                    </div>
                  </div>
                </div>
                <!-- שם משפחה -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label for="Tz" class="w3-text-grey"> שם משפחה</label>
                  <label class="w3-text-red"> * </label>
                  <br />
                  <input class="myInput" name="LastName" id="LastName" type="text" #LastName="ngModel" required
                    pInputText [(ngModel)]="contactService.currentContact.lastName" />
                  <div *ngIf="
                LastName.invalid && (LastName.touched || LastName.dirty)
                ">
                    <div *ngIf="LastName.errors.required" class="w3-text-red">
                      שדה חובה
                    </div>
                  </div>
                </div>

                <!-- יצירת קשר -->
                <div *ngIf="contactInformationValidaition == true" class="w3-text-red p-field p-col-12">
                  חובה למלאות אחד מפרטי הקשר
                </div>

                <!-- טלפון 1 -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label class="w3-text-grey">טלפון 1</label>
                  <input class="myInput" name="telephone1" id="telephone1" type="tel" #telephone1="ngModel" pInputText
                    [(ngModel)]="
                    contactService.currentContact.contactInformation
                      .telephoneNumber1
                  " pattern="^0\d([\d]{0,1})([-]{0,1})\d{7}$" (change)="OnChangeContactInformation()" />
                  <div *ngIf="
                    telephone1.errors &&
                    (telephone1.touched || telephone1.dirty)
                  " class="text-danger">
                    <div>מס' לא תקין</div>
                  </div>
                </div>

                <!-- טלפון 2 -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label class="w3-text-grey">טלפון 2</label>
                  <input class="myInput" name="telephone2" id="telephone2" type="tel" #telephone2="ngModel" pInputText
                    [(ngModel)]="
                    contactService.currentContact.contactInformation
                      .telephoneNumber2
                  " pattern="^0\d([\d]{0,1})([-]{0,1})\d{7}$" (change)="OnChangeContactInformation()" />
                  <div *ngIf="
                    telephone2.errors &&
                    (telephone2.touched || telephone2.dirty)
                  " class="text-danger">
                    <div>מס' לא תקין</div>
                  </div>
                </div>
                <!-- נייד 1 -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label class="w3-text-grey">נייד 1</label>
                  <input class="myInput" name="phone1" id="phone1" #phone1="ngModel" type="tel"
                    pattern="^0\d([\d]{0,1})([-]{0,1})\d{7}$" pInputText [(ngModel)]="
                    contactService.currentContact.contactInformation
                      .phoneNumber1
                  " (change)="OnChangeContactInformation()" />
                  <div *ngIf="phone1.errors && (phone1.touched || phone1.dirty)" class="text-danger">
                    <div>מס' לא תקין</div>
                  </div>
                </div>

                <!-- נייד 2 -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label class="w3-text-grey">נייד 2</label>
                  <input class="myInput" name="phone2" id="phone2" #phone2="ngModel" type="tel" pInputText [(ngModel)]="
                    contactService.currentContact.contactInformation
                      .phoneNumber2
                  " pattern="^0\d([\d]{0,1})([-]{0,1})\d{7}$" (change)="OnChangeContactInformation()" />
                  <div *ngIf="phone2.errors && (phone2.touched || phone2.dirty)" class="text-danger">
                    <div>מס' לא תקין</div>
                  </div>
                </div>

                <!-- נייד 3 -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label class="w3-text-grey">נייד 3</label>
                  <input class="myInput" name="phone3" id="phone3" #phone3="ngModel" type="tel" pInputText [(ngModel)]="
                    contactService.currentContact.contactInformation
                      .phoneNumber3
                  " pattern="^0\d([\d]{0,1})([-]{0,1})\d{7}$" (change)="OnChangeContactInformation()" />
                  <div *ngIf="phone3.errors && (phone3.touched || phone3.dirty)" class="text-danger">
                    <div>מס' לא תקין</div>
                  </div>
                </div>

                <!-- פקס -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label class="w3-text-grey"> פקס</label>
                  <input class="myInput" name="fax" type="text" pInputText [(ngModel)]="
                    contactService.currentContact.contactInformation.faxNumber
                  "  [pKeyFilter]="blockSpecial"/>
                </div>

                <!-- מייל -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                  <label class="w3-text-grey"> מייל</label>
                  <input class="myInput" name="emaill" id="emaill" #emaill="ngModel" type="email"
                    pattern="[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,3}$" pInputText [(ngModel)]="
                    contactService.currentContact.contactInformation.email
                  " />
                  <div *ngIf="emaill.errors && (emaill.touched || emaill.dirty)" class="text-danger">
                    <div>מייל לא תקין</div>
                  </div>
                </div>
                <!-- סוג קשר -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3"
                  *ngIf="this.studentService.flagAddOrUpdateContact == true">
                  <label class="w3-text-grey">סוג קשר</label>
                  <label class="w3-text-red"> * </label>
                  <p-dropdown appendTo="body" dir="rtl" name="typeContact" class="myInput" #typeContact="ngModel"
                    required [options]="contactService.typeContactList" optionLabel="name" [(ngModel)]="contactService.currentContacPerStudent.typeContact " 
                    [style]="{ width: '100%' }" filter="true" placeholder="בחר סוג קשר"
                    emptyFilterMessage="לא נמצאו נתונים העונים על החיפוש" emptyMessage="אין נתונים קיימים">
                  </p-dropdown>
                  <div *ngIf="
                typeContact.invalid && (typeContact.touched || typeContact.dirty)
                ">
                    <div *ngIf="typeContact.errors.required" class="w3-text-red">
                      שדה חובה
                    </div>
                  </div>
                </div>

                <!-- הערה על יצירת קשר -->
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                  <label class="w3-text-grey"> יצירת קשר-הערה </label>
                  <textarea type="text" pInputText autoResize="autoResize" class="myInput" name="commentt" [(ngModel)]="
                    contactService.currentContact.contactInformation.comment
                  "></textarea>
                </div>

              </div>
              <p-button id="btn" icon="pi pi-save" type="button" label="חזור" class="p-button-text" (click)="moveToPrev()"></p-button>
              <!-- <div *ngIf="displayModal" style="height: 150%">

                <p-dialog
                  (onHide)="flag=true"
                  [closable]="false"
                  header="שים לב"
                  icon="pi pi pi-send"
                  [(visible)]="displayModal"
                  [modal]="true"
                  [style]="{ width: '30vw' }"
                  [draggable]="false"
                  [resizable]="false"
                >
                  <h6>נמצא איש קשר זה במאגר, האם לשייך אותו לתלמיד זה</h6>
                  <p-button
                    icon="pi pi-save"
                    type="button"
                    label="שייך איש קשר לתלמיד"
                    class="p-button-text"
                    (click)="AddContactPerStudent()"
                  >
                  </p-button>
                  <p-button
                    icon="pi pi-save"
                    type="button"
                    label="ביטול"
                    class="p-button-text"
                    (click)="closeDialog()"
                  >
                  </p-button>
                  <ng-template pTemplate="footer"> </ng-template>
                </p-dialog>
              </div> -->
            </div><br>
            <p-button id="btn" icon="pi pi-save" type="button" label="שמור" class="p-button-text"
              [disabled]="form.valid != true" (click)="form.valid == true ? SaveContact() : null">
            </p-button>
          </div>
        </div>
      </form>
    </div>
  </div>
  <!-- </div> -->
</body>
<!-- message -->
<div class="p-text-center">
  <p-toast position="top-center"></p-toast>
  <p-toast position="top-center" (onClose)="onClose()" key="tl"></p-toast>
  <p-toast position="top-center" key="tc"></p-toast>
</div>





<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text">
</p-confirmDialog>